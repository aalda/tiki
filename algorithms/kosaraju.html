<html><head><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><title>tiki</title><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="Scala graph algorithms" /><meta name="author" content="com.waioeka" /><meta name="og:image" content="/tiki/img/poster.png" /><meta name="og:title" content="tiki" /><meta name="og:site_name" content="tiki" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Scala graph algorithms" /><meta name="twitter:image" content="/tiki/img/poster.png" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:site" content="" /><link rel="icon" type="image/png" href="/tiki/img/favicon.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/tiki/highlight/styles/atom-one-light.css" /><link rel="stylesheet" href="/tiki/css/style.css" /><link rel="stylesheet" href="/tiki/css/palette.css" /><link rel="stylesheet" href="/tiki/css/override.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/tiki/" class="brand"><div class="brand-wrapper" style="background:url('/tiki/img/sidebar_brand.png') no-repeat"><span>tiki</span></div></a></li>      <li><a href="/tiki/algorithms.html" class="">Algorithms</a></li> <li><a href="/tiki/algorithms/kosaraju.html" class=" active ">Strongly Connected Components</a></li> <li><a href="/tiki/algorithms/kruskal.html" class="">Minimum Spanning Tree</a></li> <li><a href="/tiki/algorithms/path.html" class="">Negative Cycle Detection</a></li> <li><a href="/tiki/algorithms/sort.html" class="">Topological Sort</a></li> <li><a href="/tiki/algorithms/traversal.html" class="">Traversal</a></li>   </ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li class="hidden-xs"><a href="https://github.com/lewismj/tiki"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li class="hidden-xs"><a href="https://github.com/lewismj/tiki"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('tiki Scala graph algorithms');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('tiki Scala graph algorithms');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="lewismj" data-github-repo="tiki"><div class="content-wrapper"><section><h1 id="strongly-connected-components">Strongly Connected Components</h1>

<p>From <a href="https://en.wikipedia.org/wiki/Strongly_connected_component">wikipedia</a></p>

<p>“<em>In the mathematical theory of directed graphs, a graph is said to be strongly connected or diconnected if
 every vertex is reachable from every other vertex. The strongly connected components or diconnected
  components of an arbitrary directed graph form a partition into subgraphs that are 
  themselves strongly connected. It is possible to test the strong connectivity of a graph, 
  or to find its strongly connected components, in linear time.</em>”</p>

<h2 id="kosarajus-algorithm">Kosaraju’s Algorithm</h2>

<ol>
  <li>
    <p>Given a digraph <em>g</em> and empty stack <em>s</em>.  While <em>s</em> does not contain all vertices:</p>

    <ul>
      <li>Pick a vertex <em>v</em> of <em>g</em> not in <em>s</em>, perform a depth first search starting at <em>v</em>,
 each time that the search finishes expanding a vertex <em>u</em> push <em>u</em> onto <em>s</em>.</li>
    </ul>
  </li>
  <li>
    <p>Transpose the graph.</p>
  </li>
  <li>
    <p>While <em>s</em> is non-empty:</p>

    <ul>
      <li>Take the vertex <em>v</em> from the head of <em>s</em>. Perform a depth first search start at <em>v</em>.
 The set of visited vertices will be the strongly connected component containing <em>v</em>.
 Remove these vertices from the transpose and <em>s</em>.</li>
    </ul>
  </li>
</ol>

<h2 id="example">Example</h2>

<p>The following graph shows the four strongly connected components:</p>

<p><img src="https://raw.github.com/lewismj/tiki/master/docs/src/main/resources/microsite/img/scc.png" alt="graph" /></p>

<h2 id="functions">Functions</h2>

<ul>
  <li><em>kosaraju(g)</em> returns a list of lists, where each sub-list is a strongly connected component of the graph <em>g</em>.</li>
</ul>

<h2 id="implementation">Implementation</h2>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code>  <span class="k">def</span> <span class="n">kosaraju</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">g</span><span class="k">:</span> <span class="kt">Digraph</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">A</span><span class="o">]]</span> <span class="k">=</span> <span class="o">{</span>

    <span class="nd">@tailrec</span>
    <span class="k">def</span> <span class="n">loop</span><span class="o">(</span><span class="n">gr</span><span class="k">:</span> <span class="kt">Digraph</span><span class="o">[</span><span class="kt">A</span><span class="o">],</span> <span class="n">s</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">A</span><span class="o">],</span> <span class="n">scc</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">A</span><span class="o">]])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">A</span><span class="o">]]</span> <span class="k">=</span> <span class="n">s</span> <span class="k">match</span> <span class="o">{</span>
      <span class="k">case</span> <span class="nc">Nil</span> <span class="k">=&gt;</span> <span class="n">scc</span>
      <span class="k">case</span> <span class="n">head</span> <span class="o">::</span> <span class="n">tail</span> <span class="k">=&gt;</span>
        <span class="k">val</span> <span class="n">component</span> <span class="k">=</span> <span class="n">dfs</span><span class="o">(</span><span class="n">gr</span><span class="o">,</span><span class="n">head</span><span class="o">).</span><span class="n">toList</span>
        <span class="n">loop</span><span class="o">(</span><span class="n">remove</span><span class="o">(</span><span class="n">gr</span><span class="o">,</span><span class="n">component</span><span class="o">),</span> <span class="n">s</span><span class="o">.</span><span class="n">diff</span><span class="o">(</span><span class="n">component</span><span class="o">),</span> <span class="n">component</span> <span class="o">::</span> <span class="n">scc</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="k">val</span> <span class="n">stack</span> <span class="k">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">foldLeft</span><span class="o">(</span><span class="nc">List</span><span class="o">.</span><span class="n">empty</span><span class="o">[</span><span class="kt">A</span><span class="o">])((</span><span class="n">a</span><span class="o">,</span><span class="n">v</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">dfs</span><span class="o">(</span><span class="n">remove</span><span class="o">(</span><span class="n">g</span><span class="o">,</span><span class="n">a</span><span class="o">),</span><span class="n">v</span><span class="o">).</span><span class="n">toList</span> <span class="o">:::</span> <span class="n">a</span><span class="o">)</span>

    <span class="n">loop</span><span class="o">(</span><span class="n">g</span><span class="o">.</span><span class="n">transpose</span><span class="o">,</span><span class="n">stack</span><span class="o">,</span><span class="nc">List</span><span class="o">.</span><span class="n">empty</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">A</span><span class="o">]])</span>
  <span class="o">}</span>
</code></pre>
</div>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">tiki._</span>
<span class="k">import</span> <span class="nn">tiki._</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">tiki.Components._</span>
<span class="k">import</span> <span class="nn">tiki.Components._</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">tiki.implicits._</span>
<span class="k">import</span> <span class="nn">tiki.implicits._</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">xs</span> <span class="k">=</span> <span class="nc">Stream</span><span class="o">(</span>
     <span class="o">|</span>   <span class="mi">1</span> <span class="o">--&gt;</span> <span class="mi">2</span><span class="o">,</span>
     <span class="o">|</span>   <span class="mi">2</span> <span class="o">--&gt;</span> <span class="mi">3</span><span class="o">,</span>
     <span class="o">|</span>   <span class="mi">2</span> <span class="o">--&gt;</span> <span class="mi">4</span><span class="o">,</span>
     <span class="o">|</span>   <span class="mi">2</span> <span class="o">--&gt;</span> <span class="mi">5</span><span class="o">,</span>
     <span class="o">|</span>   <span class="mi">3</span> <span class="o">--&gt;</span> <span class="mi">6</span><span class="o">,</span>
     <span class="o">|</span>   <span class="mi">4</span> <span class="o">--&gt;</span> <span class="mi">5</span><span class="o">,</span>
     <span class="o">|</span>   <span class="mi">4</span> <span class="o">--&gt;</span> <span class="mi">7</span><span class="o">,</span>
     <span class="o">|</span>   <span class="mi">5</span> <span class="o">--&gt;</span> <span class="mi">2</span><span class="o">,</span>
     <span class="o">|</span>   <span class="mi">5</span> <span class="o">--&gt;</span> <span class="mi">6</span><span class="o">,</span>
     <span class="o">|</span>   <span class="mi">5</span> <span class="o">--&gt;</span> <span class="mi">7</span><span class="o">,</span>
     <span class="o">|</span>   <span class="mi">6</span> <span class="o">--&gt;</span> <span class="mi">3</span><span class="o">,</span>
     <span class="o">|</span>   <span class="mi">6</span> <span class="o">--&gt;</span> <span class="mi">8</span><span class="o">,</span>
     <span class="o">|</span>   <span class="mi">7</span> <span class="o">--&gt;</span> <span class="mi">8</span><span class="o">,</span>
     <span class="o">|</span>   <span class="mi">7</span> <span class="o">--&gt;</span> <span class="mi">10</span><span class="o">,</span>
     <span class="o">|</span>   <span class="mi">8</span> <span class="o">--&gt;</span> <span class="mi">7</span><span class="o">,</span>
     <span class="o">|</span>   <span class="mi">9</span> <span class="o">--&gt;</span> <span class="mi">7</span><span class="o">,</span>
     <span class="o">|</span>   <span class="mi">10</span> <span class="o">--&gt;</span> <span class="mi">9</span><span class="o">,</span>
     <span class="o">|</span>   <span class="mi">10</span> <span class="o">--&gt;</span> <span class="mi">11</span><span class="o">,</span>
     <span class="o">|</span>   <span class="mi">11</span> <span class="o">--&gt;</span> <span class="mi">12</span><span class="o">,</span>
     <span class="o">|</span>   <span class="mi">12</span> <span class="o">--&gt;</span> <span class="mi">10</span>
     <span class="o">|</span> <span class="o">)</span>
<span class="n">xs</span><span class="k">:</span> <span class="kt">scala.collection.immutable.Stream</span><span class="o">[</span><span class="kt">tiki.Edge</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">Stream</span><span class="o">(</span><span class="nc">Edge</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">),</span> <span class="o">?)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">g</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Digraph</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="o">{</span>
     <span class="o">|</span>   <span class="k">lazy</span> <span class="k">val</span> <span class="n">ys</span> <span class="k">=</span> <span class="nc">AdjacencyList</span><span class="o">(</span><span class="n">xs</span><span class="o">)</span>
     <span class="o">|</span>   <span class="k">override</span> <span class="k">def</span> <span class="n">contains</span><span class="o">(</span><span class="n">v</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="n">ys</span><span class="o">.</span><span class="n">contains</span><span class="o">(</span><span class="n">v</span><span class="o">)</span>
     <span class="o">|</span>   <span class="k">override</span> <span class="k">def</span> <span class="n">successors</span><span class="o">(</span><span class="n">v</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Set</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="n">ys</span><span class="o">.</span><span class="n">successors</span><span class="o">(</span><span class="n">v</span><span class="o">)</span>
     <span class="o">|</span>   <span class="k">override</span> <span class="k">def</span> <span class="n">predecessors</span><span class="o">(</span><span class="n">v</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Set</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="n">ys</span><span class="o">.</span><span class="n">predecessors</span><span class="o">(</span><span class="n">v</span><span class="o">)</span>
     <span class="o">|</span>   <span class="k">override</span> <span class="k">def</span> <span class="n">vertices</span><span class="k">:</span> <span class="kt">Stream</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="n">ys</span><span class="o">.</span><span class="n">vertices</span>
     <span class="o">|</span>   <span class="k">override</span> <span class="k">def</span> <span class="n">edges</span><span class="k">:</span> <span class="kt">Stream</span><span class="o">[</span><span class="kt">EdgeLike</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span> <span class="n">xs</span>
     <span class="o">|</span> <span class="o">}</span>
<span class="n">g</span><span class="k">:</span> <span class="kt">tiki.Digraph</span><span class="o">[</span><span class="kt">Int</span><span class="o">]{</span><span class="k">lazy</span> <span class="k">val</span> <span class="n">ys</span><span class="k">:</span> <span class="kt">tiki.AdjacencyList</span><span class="o">[</span><span class="kt">Int</span><span class="o">]}</span> <span class="k">=</span> <span class="nc">$anon$1</span><span class="k">@</span><span class="mi">79</span><span class="n">cb08ad</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">scc</span> <span class="k">=</span> <span class="n">kosaraju</span><span class="o">(</span><span class="n">g</span><span class="o">).</span><span class="n">toSet</span>
<span class="n">scc</span><span class="k">:</span> <span class="kt">scala.collection.immutable.Set</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">Set</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mi">8</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">12</span><span class="o">,</span> <span class="mi">11</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">6</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">scc</span><span class="o">.</span><span class="n">mkString</span><span class="o">(</span><span class="s">","</span><span class="o">)</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">8</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">12</span><span class="o">,</span> <span class="mi">11</span><span class="o">),</span><span class="nc">List</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">6</span><span class="o">),</span><span class="nc">List</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">),</span><span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
</code></pre>
</div>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/tiki/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script src="/tiki/js/main.js"></script></body></html>